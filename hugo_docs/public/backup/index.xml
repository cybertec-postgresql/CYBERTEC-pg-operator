<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Backup on CYBERTEC-PG-Operator</title>
    <link>http://localhost:1313/CYBERTEC-pg-operator/backup/</link>
    <description>Recent content in Backup on CYBERTEC-PG-Operator</description>
    <generator>Hugo</generator>
    <language>en</language>
    <lastBuildDate>Thu, 28 Dec 2023 14:26:51 +0100</lastBuildDate>
    <atom:link href="http://localhost:1313/CYBERTEC-pg-operator/backup/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Introduction</title>
      <link>http://localhost:1313/CYBERTEC-pg-operator/backup/introduction/</link>
      <pubDate>Thu, 28 Dec 2023 14:26:51 +0100</pubDate>
      <guid>http://localhost:1313/CYBERTEC-pg-operator/backup/introduction/</guid>
      <description>&lt;p&gt;Backups are essential for databases. From broken storage to deployments gone wrong, backups often save the day. Starting with pg_dump, which was released in the late 1990s, to the archiving of WAL files (PostgreSQL 8.0 / 2005) and pg_basebackup (PostgreSQL 9.0 / 2010), PostgreSQL already offers built-in options for backups and restores based on logical and physical backups.&lt;/p&gt;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;backups-with-pgbackrest&#34;&#xA;    &gt;&#xA;        Backups with pgBackRest&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/introduction/#backups-with-pgbackrest&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Backups with pgBackRest&#34; aria-label=&#34;Anchor to: Backups with pgBackRest&#34; href=&#34;#backups-with-pgbackrest&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;CPO relies on &lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;www.pgbackrest.org&#34;&#xA;&gt;pgBackRest&lt;/a&gt; as its backup solution, a tried-and-tested tool with extensive backup and restore options.&#xA;The backup is based on two elements:&lt;/p&gt;</description>
    </item>
    <item>
      <title>via Blockstorage (pvc)</title>
      <link>http://localhost:1313/CYBERTEC-pg-operator/backup/pvc/</link>
      <pubDate>Thu, 28 Dec 2023 14:26:51 +0100</pubDate>
      <guid>http://localhost:1313/CYBERTEC-pg-operator/backup/pvc/</guid>
      <description>&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;backups-on-pvc-persistentvolumeclaim&#34;&#xA;    &gt;&#xA;        Backups on PVC (PersistentVolumeClaim)&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/pvc/#backups-on-pvc-persistentvolumeclaim&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Backups on PVC (PersistentVolumeClaim)&#34; aria-label=&#34;Anchor to: Backups on PVC (PersistentVolumeClaim)&#34; href=&#34;#backups-on-pvc-persistentvolumeclaim&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;When using block storage, the operator creates an additional pod that acts as a repo host. Based on a TLS connection, the repo host obtains the data for the Backup from the current primary of the cluster, which is compressed before being sent.&#xA;WAL archives are pushed from the primary pod to the repo host.&lt;/p&gt;</description>
    </item>
    <item>
      <title>via S3</title>
      <link>http://localhost:1313/CYBERTEC-pg-operator/backup/aws/</link>
      <pubDate>Thu, 28 Dec 2023 14:26:51 +0100</pubDate>
      <guid>http://localhost:1313/CYBERTEC-pg-operator/backup/aws/</guid>
      <description>&lt;p&gt;This chapter describes the use of pgBackRest in combination with with AWS S3 or S3-compatible storage such as MinIO, Cloudian HyperStore or SwiftStack. It is not absolutely necessary to operate a Kubernetes on the AWS  Cloud Platform. However, as with any cloud storage, the efficiency and therefore the duration of a backup depends on the connection.&lt;/p&gt;&#xA;&lt;p&gt;This Chapter will use AWS S3 for the example, the usage of different s3-compatible Storage is similiar.&lt;/p&gt;</description>
    </item>
    <item>
      <title>via GCS</title>
      <link>http://localhost:1313/CYBERTEC-pg-operator/backup/gcs/</link>
      <pubDate>Thu, 28 Dec 2023 14:26:51 +0100</pubDate>
      <guid>http://localhost:1313/CYBERTEC-pg-operator/backup/gcs/</guid>
      <description>&lt;p&gt;This chapter describes the use of pgBackRest in combination with Google Cloud Storage (gcs). It is not absolutely necessary to operate a Kubernetes on the Google Cloud Platform. However, as with any cloud storage, the efficiency and therefore the duration of a backup depends on the connection.&lt;/p&gt;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&lt;blockquote class=&#34;gdoc-hint important&#34;&gt;&#xA;  &lt;div class=&#34;gdoc-hint__title flex align-center&#34;&gt;&lt;i class=&#34;fa important&#34; title=&#34;Important&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;gdoc-hint__text&#34;&gt;Precondition: a gcs-bucket and a priviledged role is needed for this chapter.&lt;/div&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;create-a-gcs-bucket-on-the-google-cloud-console&#34;&#xA;    &gt;&#xA;        Create a gcs-bucket on the google cloud console&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/gcs/#create-a-gcs-bucket-on-the-google-cloud-console&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Create a gcs-bucket on the google cloud console&#34; aria-label=&#34;Anchor to: Create a gcs-bucket on the google cloud console&#34; href=&#34;#create-a-gcs-bucket-on-the-google-cloud-console&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;create-a-priviledged-service-role&#34;&#xA;    &gt;&#xA;        Create a priviledged service-role&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/gcs/#create-a-priviledged-service-role&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Create a priviledged service-role&#34; aria-label=&#34;Anchor to: Create a priviledged service-role&#34; href=&#34;#create-a-priviledged-service-role&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;modifying-the-cluster&#34;&#xA;    &gt;&#xA;        Modifying the Cluster&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/gcs/#modifying-the-cluster&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Modifying the Cluster&#34; aria-label=&#34;Anchor to: Modifying the Cluster&#34; href=&#34;#modifying-the-cluster&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;As soon as all requirements are met:&lt;/p&gt;</description>
    </item>
    <item>
      <title>via Azure-Blob</title>
      <link>http://localhost:1313/CYBERTEC-pg-operator/backup/azure_blob/</link>
      <pubDate>Thu, 28 Dec 2023 14:26:51 +0100</pubDate>
      <guid>http://localhost:1313/CYBERTEC-pg-operator/backup/azure_blob/</guid>
      <description>&lt;p&gt;This chapter describes the use of pgBackRest in combination with Azure Blob Storage. It is not absolutely necessary to operate a Kubernetes on the Azure Cloud Platform. However, as with any cloud storage, the efficiency and therefore the duration of a backup depends on the connection.&lt;/p&gt;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&lt;blockquote class=&#34;gdoc-hint important&#34;&gt;&#xA;  &lt;div class=&#34;gdoc-hint__title flex align-center&#34;&gt;&lt;i class=&#34;fa important&#34; title=&#34;Important&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;gdoc-hint__text&#34;&gt;Precondition: a blob-storage-volume and a priviledged role is needed for this chapter.&lt;/div&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;create-a-blob-storage-volume-on-the-azure-console&#34;&#xA;    &gt;&#xA;        Create a blob-storage-volume on the Azure console&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/azure_blob/#create-a-blob-storage-volume-on-the-azure-console&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Create a blob-storage-volume on the Azure console&#34; aria-label=&#34;Anchor to: Create a blob-storage-volume on the Azure console&#34; href=&#34;#create-a-blob-storage-volume-on-the-azure-console&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;create-a-priviledged-service-role&#34;&#xA;    &gt;&#xA;        Create a priviledged service-role&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/azure_blob/#create-a-priviledged-service-role&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Create a priviledged service-role&#34; aria-label=&#34;Anchor to: Create a priviledged service-role&#34; href=&#34;#create-a-priviledged-service-role&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;modifying-the-cluster&#34;&#xA;    &gt;&#xA;        Modifying the Cluster&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/azure_blob/#modifying-the-cluster&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Modifying the Cluster&#34; aria-label=&#34;Anchor to: Modifying the Cluster&#34; href=&#34;#modifying-the-cluster&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;As soon as all requirements are met:&lt;/p&gt;</description>
    </item>
    <item>
      <title>Encrypted Backups</title>
      <link>http://localhost:1313/CYBERTEC-pg-operator/backup/encryption/</link>
      <pubDate>Thu, 28 Dec 2023 14:26:51 +0100</pubDate>
      <guid>http://localhost:1313/CYBERTEC-pg-operator/backup/encryption/</guid>
      <description>&lt;p&gt;pgBackRest also allows you to encrypt your backups on the client side before uploading them. This is possible with any type of storage and is very easy to activate.&lt;/p&gt;&#xA;&lt;p&gt;Firstly, we need to define an encryption key. This must be specified separately for each repo and stored in the same secret that is defined in the &lt;code&gt;spec.backup.pgbackrest.configuration.secret&lt;/code&gt; object.&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;kind: Secret&#xA;apiVersion: v1&#xA;metadata:&#xA;  name: cluster-1-s3-credential&#xA;  namespace: cpo&#xA;stringData:&#xA;  s3.conf |&#xA;    [global]&#xA;    repo1-s3-key=YOUR_S3_KEY&#xA;    repo1-s3-key-secret=YOUR_S3_KEY_SECRET&#xA;    repo1-cipher-pass=YOUR_ENCRYPTION_KEY&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We also need to configure the type of encryption for pgBackRest. This is done via the cipher-type parameter, which must also be specified for each repo.  You can find the available values for the parameter &lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://pgbackrest.org/configuration.html#section-repository/option-repo-cipher-type&#34;&#xA;&gt;here&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Check/Monitor Backups</title>
      <link>http://localhost:1313/CYBERTEC-pg-operator/backup/check_backups/</link>
      <pubDate>Thu, 28 Dec 2023 14:26:51 +0100</pubDate>
      <guid>http://localhost:1313/CYBERTEC-pg-operator/backup/check_backups/</guid>
      <description>&lt;p&gt;There are several ways to gain an insight into the current status of pgBackRest.&#xA;One of these is to use pgBackRest within the container. This can be done both via the repo host and the Postgres pod.&lt;/p&gt;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;pgbackrest-via-terminal-repo-host-pod&#34;&#xA;    &gt;&#xA;        pgbackrest via terminal (Repo-Host-Pod)&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/check_backups/#pgbackrest-via-terminal-repo-host-pod&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: pgbackrest via terminal (Repo-Host-Pod)&#34; aria-label=&#34;Anchor to: pgbackrest via terminal (Repo-Host-Pod)&#34; href=&#34;#pgbackrest-via-terminal-repo-host-pod&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;kubectl exec cluster-5-pgbackrest-repo-host-0 --stdin --tty -- pgbackrest info &#xA;stanza: db&#xA;    status: ok&#xA;    cipher: none&#xA;&#xA;    db (current)&#xA;        wal archive min/max (16): 00000006000000000000005C/000000070000000000000092&#xA;&#xA;        full backup: 20240517-125730F&#xA;            timestamp start/stop: 2024-05-17 12:57:30+00 / 2024-05-17 12:57:41+00&#xA;            wal start/stop: 00000007000000000000005E / 00000007000000000000005E&#xA;            database size: 22.9MB, database backup size: 22.9MB&#xA;            repo1: backup set size: 3MB, backup size: 3MB&#xA;&#xA;        incr backup: 20240517-125730F_20240517-130003I&#xA;            timestamp start/stop: 2024-05-17 13:00:03+00 / 2024-05-17 13:00:05+00&#xA;            wal start/stop: 000000070000000000000060 / 000000070000000000000060&#xA;            database size: 22.9MB, database backup size: 904.3KB&#xA;            repo1: backup set size: 3MB, backup size: 149.4KB&#xA;            backup reference list: 20240517-125730F&#xA;&#xA;        incr backup: 20240517-125730F_20240517-131503I&#xA;            timestamp start/stop: 2024-05-17 13:15:03+00 / 2024-05-17 13:15:04+00&#xA;            wal start/stop: 000000070000000000000062 / 000000070000000000000062&#xA;            database size: 22.9MB, database backup size: 24.3KB&#xA;            repo1: backup set size: 3MB, backup size: 2.9KB&#xA;            backup reference list: 20240517-125730F, 20240517-125730F_20240517-130003I&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;pgbackrest-via-terminal-postgres-pod&#34;&#xA;    &gt;&#xA;        pgbackrest via terminal (Postgres-Pod)&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;http://localhost:1313/CYBERTEC-pg-operator/backup/check_backups/#pgbackrest-via-terminal-postgres-pod&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: pgbackrest via terminal (Postgres-Pod)&#34; aria-label=&#34;Anchor to: pgbackrest via terminal (Postgres-Pod)&#34; href=&#34;#pgbackrest-via-terminal-postgres-pod&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;kubectl exec cluster-5-0 --stdin --tty -- pgbackrest info &#xA;Defaulted container &amp;#34;postgres&amp;#34; out of: postgres, postgres-exporter, pgbackrest-restore (init)&#xA;stanza: db&#xA;    status: ok&#xA;    cipher: none&#xA;&#xA;    db (current)&#xA;        wal archive min/max (16): 00000006000000000000005C/000000070000000000000092&#xA;&#xA;        full backup: 20240517-125730F&#xA;            timestamp start/stop: 2024-05-17 12:57:30+00 / 2024-05-17 12:57:41+00&#xA;            wal start/stop: 00000007000000000000005E / 00000007000000000000005E&#xA;            database size: 22.9MB, database backup size: 22.9MB&#xA;            repo1: backup set size: 3MB, backup size: 3MB&#xA;&#xA;        incr backup: 20240517-125730F_20240517-130003I&#xA;            timestamp start/stop: 2024-05-17 13:00:03+00 / 2024-05-17 13:00:05+00&#xA;            wal start/stop: 000000070000000000000060 / 000000070000000000000060&#xA;            database size: 22.9MB, database backup size: 904.3KB&#xA;            repo1: backup set size: 3MB, backup size: 149.4KB&#xA;            backup reference list: 20240517-125730F&#xA;&#xA;        incr backup: 20240517-125730F_20240517-131503I&#xA;            timestamp start/stop: 2024-05-17 13:15:03+00 / 2024-05-17 13:15:04+00&#xA;            wal start/stop: 000000070000000000000062 / 000000070000000000000062&#xA;            database size: 22.9MB, database backup size: 24.3KB&#xA;            repo1: backup set size: 3MB, backup size: 2.9KB&#xA;            backup reference list: 20240517-125730F, 20240517-125730F_20240517-130003I&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;There is the &amp;ldquo;normal&amp;rdquo; output, as well as the output format Json, which can be processed directly in the terminal.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
